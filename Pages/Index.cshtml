@page
@using static Nedflix.Pages.IndexModel;
@model Nedflix.Pages.IndexModel
@{
	ViewData["Title"] = "Nedflix";
}
@functions{
	public async void OnPost()
	{
		Movie mov = await Model.HttpContext.Request.ReadFromJsonAsync<Movie>();
	}
}
<script>
	let params = {
				method:"GET",
				headers:
				{
					"Content-Type" : "application/json",
					"X-API-KEY": "c278dfaf-f118-4523-8b32-831ddded96b1"
				}
			}
	function GetCountries(){
		//fetch("https://kinopoiskapiunofficial.tech/api/v2.2/films/filters", params).then(r=>return r.json())
	}
	function GetMovies(countryId){
		if(!Number.isInteger(countryId)) {console.log(countryId + " Is NaN"); return }
		fetch("https://kinopoiskapiunofficial.tech/api/v2.2/films?countries="+countryId+"&ratingFrom=0&ratingTo=10&yearFrom=1000&yearTo=3000&page=1",
		params).then(r => r.json()).then(j=>console.log(j))
	}

	function PostMovies(moviesObj)
	{
		fetch("/Index", {
			method:"POST",
			headers: {"Content-Type" : "application/json",
			body: JSON.stringify(moviesObj)}
		})
	}
	PostMovies(GetMovies(1))
</script>